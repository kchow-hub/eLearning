<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>G2_éŸ³æ¬£_U3_ã€ç¬¬å››èª²ï¼šã€Šçš®çˆ¾é‡‘ç¬¬ä¸€è™Ÿçµ„æ›²ï¼æ¸…æ™¨ã€‹ã€‘ è‘›åˆ©æ ¼(1843-1907)</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --error-color: #f44336;
            --bg-color: #f0f8ff;
        }

        body {
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
        }

        #game-container {
            width: 95%;
            max-width: 600px;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            margin-top: 20px;
            text-align: center;
        }

        .header {
            background: #fff3e0;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid #ffb74d;
        }

        h2 { color: #e65100; margin: 5px 0; font-size: 1.2rem; }
        h3 { color: #5d4037; margin: 5px 0; font-size: 1rem; }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: bold;
            color: #555;
        }

        .youtube-btn {
            background-color: #ff0000;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-box {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .speaker-btn {
            background: #eee;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 25px;
            cursor: pointer;
            margin-top: 10px;
        }

        .options-container {
            display: grid;
            gap: 15px;
        }

        .option-btn {
            background: white;
            border: 3px solid var(--secondary-color);
            padding: 20px;
            font-size: 1.2rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
        }

        .option-btn:active {
            transform: scale(0.95);
        }

        .correct {
            background-color: #c8e6c9 !important;
            border-color: #4caf50 !important;
        }

        .wrong {
            background-color: #ffcdd2 !important;
            border-color: #f44336 !important;
        }

        #feedback-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0,0,0,0.3);
            z-index: 100;
            width: 80%;
            text-align: center;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 99;
        }

        #result-screen {
            display: none;
            text-align: center;
        }

        .next-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div class="header">
        <h2>ã€ç¬¬å››èª²ï¼šã€Šçš®çˆ¾é‡‘ç¬¬ä¸€è™Ÿçµ„æ›²ï¼æ¸…æ™¨ã€‹ã€‘</h2>
        <h3>è‘›åˆ©æ ¼(1843-1907)</h3>
        <p style="font-size: 0.8rem;">Peer Gynt Suite No.1 - Morning Mood (Edvard Grieg)</p>
        <a href="https://www.youtube.com/watch?v=aMs0rNtBZJk" target="_blank" class="youtube-btn">
            <span>â–¶</span> æ’­æ”¾éŸ³æ¨‚å½±ç‰‡
        </a>
    </div>

    <div id="quiz-section">
        <div class="progress-bar">
            <span id="progress-text">å·²å®Œæˆï¼š0 / 12</span>
            <span id="remain-text">é¤˜ä¸‹ï¼š12 é¡Œ</span>
        </div>

        <div class="question-box">
            <div id="question-text">é¡Œç›®è¼‰å…¥ä¸­...</div>
            <button class="speaker-btn" onclick="speakQuestion()">ğŸ”Š</button>
        </div>

        <div class="options-container" id="options">
            </div>
    </div>

    <div id="result-screen">
        <h1 style="color: var(--primary-color);">å¤ªæ£’äº†ï¼å®Œæˆè¤‡ç¿’ï¼</h1>
        <p id="final-score" style="font-size: 1.5rem;"></p>
        <button class="next-btn" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
    </div>
</div>

<div class="overlay" id="overlay"></div>
<div id="feedback-popup">
    <h2 id="feedback-title" style="color: red;">ç­”éŒ¯äº†ï¼</h2>
    <p id="feedback-msg" style="font-size: 1.3rem;"></p>
    <button class="next-btn" onclick="closeFeedback()">ä¸‹ä¸€é¡Œ</button>
</div>

<script>
    // é¡Œåº«æ•¸æ“š
    const questions = [
        { q: "ã€Šçš®çˆ¾é‡‘ç¬¬ä¸€è™Ÿçµ„æ›²Â·æ¸…æ™¨ã€‹ä¸€æ›²æç¹ªæ‘©æ´›å“¥å“ªä¸€å€‹æƒ…æ™¯ï¼Ÿ", a: "å¤ªé™½ä¸Šå‡", o: ["å¤ªé™½ä¸Šå‡", "å¤ªé™½ä¸‹å±±", "æ­£åˆæ™‚åˆ†"] },
        { q: "é›™ç°§ç®¡å’Œé•·ç¬›å±¬æ–¼ä»¥ä¸‹å“ªä¸€å€‹æ¨‚å™¨çµ„åˆ¥ï¼Ÿ", a: "æœ¨ç®¡æ¨‚å™¨", o: ["æœ¨ç®¡æ¨‚å™¨", "æ•²æ“Šæ¨‚å™¨", "å¼¦æ¨‚å™¨"] },
        { q: "ä»¥ä¸‹å“ªä¸€å€‹æ„å¤§åˆ©æ–‡æ˜¯é€£éŸ³çš„æ„æ€ï¼Ÿ", a: "Legato", o: ["Legato", "Accelerando", "Staccato"] },
        { q: "è‘›åˆ©æ ¼(Edvard Grieg)å‡ºç”Ÿæ–¼å“ªä¸€å€‹åœ‹å®¶ï¼Ÿ", a: "æŒªå¨", o: ["æŒªå¨", "ä¿„åœ‹", "æ„å¤§åˆ©"] },
        { q: "ã€Šçš®çˆ¾é‡‘ç¬¬ä¸€çµ„æ›²Â·æ¸…æ™¨ã€‹æ˜¯ä¸€éƒ¨ç”šéº¼é¡å‹çš„ä½œå“ï¼Ÿ", a: "æˆ²åŠ‡", o: ["æˆ²åŠ‡", "é›»å½±", "èŠ­è•¾èˆåŠ‡"] },
        { q: "è–ç¶“å‘Šè¨´æˆ‘å€‘ï¼Œæ˜¯èª°å‰µé€ äº†é€™å€‹ä¸–ç•Œï¼Ÿ", a: "ç¥", o: ["ç¥", "è€å¸«", "çˆ¶æ¯"] },
        { q: "æ¨‚æ›²çš„ä¸»é¡Œæ—‹å¾‹èµ·åˆç”±é•·ç¬›å’Œ__________ä»¥é€£éŸ³æ–¹å¼æ¼”å¥ã€‚", a: "é›™ç°§ç®¡", o: ["é›™ç°§ç®¡", "å–®ç°§ç®¡", "å·´æ¾ç®¡"] },
        { q: "åœ¨ã€Šæ¸…æ™¨ã€‹ä¸­ï¼Œæœ€å¾Œç”±æ•´å€‹__________æ¼”å¥ï¼Œæè¿°å¤ªé™½ç·©ç·©ä¸Šå‡ã€‚", a: "ç®¡å¼¦æ¨‚åœ˜", o: ["ç®¡å¼¦æ¨‚åœ˜", "å¼¦æ¨‚éšŠ", "åˆå”±åœ˜"] },
        { q: "æœ¬èª²ä¸­ï¼Œçš®çˆ¾é‡‘åˆ°äº†åŒ—éçš„__________æ¢éšªï¼Œçœ‹è¦‹å¤ªé™½ä¸Šå‡çš„ç¾æ™¯ã€‚", a: "æ‘©æ´›å“¥", o: ["æ‘©æ´›å“¥", "åŸƒåŠ", "å—é"] },
        { q: "æ¨‚æ›²çš„æ‹å­è¨˜è™Ÿæ˜¯__________ã€‚", a: "6/8", o: ["6/8", "3/4", "4/4"] },
        { q: "æ¨‚æ›²é‹ç”¨äº†__________èª¿ä¾†è¡¨é”æ‘©æ´›å“¥å¤ªé™½ä¸Šå‡çš„ç¾æ™¯ã€‚", a: "å¤§èª¿", o: ["å¤§èª¿", "å°èª¿"] },
        { q: "å¼·å¼±è¨˜è™Ÿ ff ä»£è¡¨ç”šéº¼æ„æ€ï¼Ÿ", a: "æ¥µå¼·", o: ["æ¥µå¼·", "å¾ˆå¼±", "ä¸­å¼·"] }
    ];

    let currentIdx = 0;
    let shuffledQuestions = [];
    let score = 0;

    // åˆå§‹åŒ–éŠæˆ²
    function initGame() {
        shuffledQuestions = questions.sort(() => Math.random() - 0.5);
        showQuestion();
    }

    function showQuestion() {
        if (currentIdx >= shuffledQuestions.length) {
            showResult();
            return;
        }

        const qData = shuffledQuestions[currentIdx];
        document.getElementById("question-text").innerText = qData.q;
        
        // æ›´æ–°é€²åº¦
        document.getElementById("progress-text").innerText = `å·²å®Œæˆï¼š${currentIdx} / ${shuffledQuestions.length}`;
        document.getElementById("remain-text").innerText = `é¤˜ä¸‹ï¼š${shuffledQuestions.length - currentIdx} é¡Œ`;

        // ç”Ÿæˆé¸é …
        const optionsDiv = document.getElementById("options");
        optionsDiv.innerHTML = "";
        const shuffledOptions = [...qData.o].sort(() => Math.random() - 0.5);
        
        shuffledOptions.forEach(opt => {
            const btn = document.createElement("button");
            btn.className = "option-btn";
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(opt, btn);
            optionsDiv.appendChild(btn);
        });

        // è‡ªå‹•æœ—è®€
        setTimeout(() => speakQuestion(), 500);
    }

    function checkAnswer(selected, btn) {
        const correctAns = shuffledQuestions[currentIdx].a;
        const allBtns = document.querySelectorAll(".option-btn");
        
        // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•é˜²æ­¢é‡è¤‡é»æ“Š
        allBtns.forEach(b => b.style.pointerEvents = "none");

        if (selected === correctAns) {
            btn.classList.add("correct");
            score++;
            playTone(800, 0.2); // ç­”å°éŸ³æ•ˆ
            setTimeout(() => {
                currentIdx++;
                showQuestion();
            }, 1000);
        } else {
            btn.classList.add("wrong");
            playTone(200, 0.4); // ç­”éŒ¯éŸ³æ•ˆ
            showFeedback(correctAns);
        }
    }

    function showFeedback(correct) {
        document.getElementById("feedback-msg").innerText = `æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${correct}`;
        document.getElementById("overlay").style.display = "block";
        document.getElementById("feedback-popup").style.display = "block";
    }

    function closeFeedback() {
        document.getElementById("overlay").style.display = "none";
        document.getElementById("feedback-popup").style.display = "none";
        currentIdx++;
        showQuestion();
    }

    function showResult() {
        document.getElementById("quiz-section").style.display = "none";
        document.getElementById("result-screen").style.display = "block";
        document.getElementById("final-score").innerText = `å¾—åˆ†ï¼š${score} / ${shuffledQuestions.length}`;
    }

    // èªéŸ³åŠŸèƒ½
    function speakQuestion() {
        const text = document.getElementById("question-text").innerText;
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'zh-HK';
        utterance.rate = 0.9;
        window.speechSynthesis.cancel(); // åœæ­¢ä¹‹å‰çš„æœ—è®€
        window.speechSynthesis.speak(utterance);
    }

    // ç°¡æ˜“éŸ³æ•ˆç”Ÿæˆå™¨ (ä¸éœ€è¦å¤–éƒ¨æª”æ¡ˆ)
    function playTone(freq, duration) {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        oscillator.frequency.value = freq;
        oscillator.type = 'sine';
        oscillator.start();
        gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
        oscillator.stop(audioCtx.currentTime + duration);
    }

    // å•Ÿå‹•éŠæˆ²
    initGame();
</script>

</body>
</html>