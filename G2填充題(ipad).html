<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°äºŒä¸­æ–‡æŒ‘æˆ° - iPad é›¢ç·šéŸ³æ•ˆç‰ˆ</title>
    <style>
        :root { --primary: #ff922b; --success: #51cf66; --error: #ff6b6b; --bg: #fff9db; }
        body { font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif; background-color: var(--bg); margin: 0; display: flex; justify-content: center; touch-action: manipulation; }
        
        /* å•Ÿå‹•ç•«é¢ */
        #splash-screen { position: fixed; inset: 0; background: var(--primary); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; }
        .start-btn { padding: 30px 80px; font-size: 40px; background: white; color: var(--primary); border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 10px 0 #d9480f; }

        .container { width: 95vw; max-width: 800px; height: 92vh; background: white; margin-top: 4vh; border-radius: 40px; box-shadow: 0 15px 0 #fcc419; border: 8px solid #fab005; display: flex; flex-direction: column; position: relative; overflow: hidden; }
        .header { padding: 20px; background: #fff3bf; border-bottom: 5px solid #fab005; display: flex; justify-content: space-between; align-items: center; font-size: 26px; font-weight: bold; color: #e67700; }
        .content { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .question-text { font-size: 34px; line-height: 1.6; color: #495057; background: #f8f9fa; padding: 30px; border-radius: 30px; width: 85%; margin-bottom: 25px; border: 2px solid #e9ecef; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; padding: 0 20px; box-sizing: border-box; }
        .opt-btn { padding: 25px; font-size: 30px; cursor: pointer; border: 4px solid #ffe066; border-radius: 25px; background: white; font-weight: bold; color: #f08c00; box-shadow: 0 8px 0 #ffe066; }
        .word-hint { font-size: 65px; letter-spacing: 15px; margin-bottom: 20px; font-weight: bold; }
        input[type="text"] { font-size: 55px; width: 120px; height: 120px; text-align: center; border: 6px solid var(--primary); border-radius: 30px; outline: none; background: #fff9db; }
        .big-btn { background: var(--primary); color: white; padding: 20px 60px; font-size: 30px; border: none; border-radius: 25px; box-shadow: 0 8px 0 #d9480f; cursor: pointer; font-weight: bold; }
        .feedback-overlay { position: absolute; inset: 0; background: rgba(255,255,255,0.98); z-index: 100; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        #report-card { position: absolute; inset: 0; background: white; z-index: 200; display: none; flex-direction: column; align-items: center; padding: 40px; }
    </style>
</head>
<body>

<div id="splash-screen">
    <h1 style="font-size: 60px; margin-bottom: 40px;">ğŸ¦ ä¸­æ–‡å°å°ˆå®¶</h1>
    <p style="font-size: 24px; margin-bottom: 40px;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•é–‹å•Ÿè²éŸ³</p>
    <button class="start-btn" onclick="startGame()">é»æ“Šé–‹å§‹</button>
</div>

<div class="container">
    <div class="header">
        <span>ç¬¬ <span id="progress">1</span> / 20 é¡Œ</span>
        <span>åˆ†æ•¸: <span id="score">0</span></span>
    </div>

    <div class="content">
        <div id="mode-label" style="color: #fd7e14; font-weight: bold; margin-bottom: 15px; font-size: 22px;"></div>
        <div class="question-text" id="q-box"></div>
        <div id="select-area" class="options-grid"></div>
        <div id="input-area" style="display:none; text-align:center;">
            <div class="word-hint" id="w-hint"></div>
            <input type="text" id="u-input" maxlength="1">
            <br><br>
            <button class="big-btn" onclick="checkInput()">æª¢æŸ¥ç­”æ¡ˆ</button>
        </div>
    </div>

    <div id="feedback-layer" class="feedback-overlay">
        <div id="fb-icon" style="font-size:100px;"></div>
        <div id="fb-msg" style="font-size:40px; font-weight:bold; margin:20px 0;"></div>
        <div id="fb-sub" style="font-size:30px; margin-bottom:40px;"></div>
        <button class="big-btn" style="background:#51cf66; box-shadow: 0 8px 0 #2b8a3e;" onclick="closeFeedback()">ä¸‹ä¸€é¡Œ</button>
    </div>

    <div id="report-card">
        <h1 style="font-size: 55px; color: #f08c00;">ğŸŠ æŒ‘æˆ°å®Œæˆï¼</h1>
        <p style="font-size: 35px;">ä½ çš„ç¸½åˆ†ï¼š<span id="final-score">0</span></p>
        <div id="wrong-list-box" style="width: 100%; text-align: left; font-size: 24px;"></div>
        <button class="big-btn" style="margin-top:40px; background:#51cf66;" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
    </div>
</div>

<script>
    // å…§åµŒå¼çŸ­éŸ³æ•ˆ (ä¸éœ€é€£ç¶²)
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playTone(freq, type, duration) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.type = type;
        osc.frequency.value = freq;
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    function playWinSound() {
        playTone(523.25, 'sine', 0.1); // C5
        setTimeout(() => playTone(659.25, 'sine', 0.1), 100); // E5
        setTimeout(() => playTone(783.99, 'sine', 0.3), 200); // G5
    }

    function playLoseSound() {
        playTone(293.66, 'square', 0.2); // D4
        setTimeout(() => playTone(220.00, 'square', 0.4), 200); // A3
    }

    function playFinishSound() {
        [523, 659, 783, 1046].forEach((f, i) => {
            setTimeout(() => playTone(f, 'triangle', 0.5), i * 150);
        });
    }

    const quizData = [
        { w: "æ„›è­·", s: "æˆ‘å€‘æ‡‰è©²___å…¬ç‰©ï¼Œä¸æ‡‰éš¨æ„ç ´å£ã€‚" },
        { w: "å¥½åƒ", s: "å¤©ä¸Šçš„ç™½é›²ä¸€æœµæœµï¼Œ___æŸ”è»Ÿçš„æ£‰èŠ±ã€‚" },
        { w: "ç¨®æ¤", s: "è¾²å¤«åœ¨ç”°è£___äº†ä¸å°‘æ–°é®®çš„è”¬èœã€‚" },
        { w: "å¼µé–‹", s: "å°é³¥___ç¿…è†€ï¼Œåœ¨å¤©ç©ºä¸­è‡ªç”±åœ°é£›ç¿”ã€‚" },
        { w: "ä¹˜æ¶¼", s: "å¤å¤©æ™‚ï¼Œè€äººå®¶å–œæ­¡åœ¨å¤§æ¨¹ä¸‹___ã€‚" },
        { w: "èˆˆå¥®", s: "è½åˆ°è¦åˆ°æµ·æ´‹å…¬åœ’çš„æ¶ˆæ¯ï¼Œæˆ‘å€‘éƒ½æ„Ÿåˆ°ååˆ†___ã€‚" },
        { w: "å®¹æ˜“", s: "é€™é“æ•¸å­¸é¡Œå¾ˆ___ï¼Œæˆ‘å¾ˆå¿«å°±åšå¥½äº†ã€‚" },
        { w: "æ…šæ„§", s: "å°æ˜å› ç‚ºèªªäº†è¬Šè©±ï¼Œæ„Ÿåˆ°ååˆ†___ã€‚" },
        { w: "åŠªåŠ›", s: "åªè¦___è¤‡ç¿’ï¼Œè€ƒè©¦ä¸€å®šèƒ½å–å¾—å¥½æˆç¸¾ã€‚" },
        { w: "ç™¼ç¾", s: "æˆ‘åœ¨å…¬åœ’çš„è‰å¢è£___äº†ä¸€éš»å°è¸ç‰›ã€‚" },
        { w: "å„ªç•°", s: "å§å§æ†‘ç€___çš„æˆç¸¾ï¼Œç²å¾—äº†é€²æ­¥çã€‚" },
        { w: "é ˜ç", s: "æ¯”è³½çµæŸå¾Œï¼Œå¾—çè€…ä¾æ¬¡ä¸Šå°___ã€‚" },
        { w: "ç­”æ‡‰", s: "åª½åª½___æˆ‘ï¼Œæ˜ŸæœŸå…­å¸¶æˆ‘å»åœ–æ›¸é¤¨ã€‚" },
        { w: "å‘½ä»¤", s: "éšŠé•·ç™¼å‡º___ï¼Œè¦æ±‚å¤§å®¶é›†åˆã€‚" },
        { w: "å¥”è·‘", s: "é‹å‹•å“¡åœ¨è·‘é“ä¸Šæ‹¼å‘½___ã€‚" },
        { w: "æ´¾ç™¼", s: "è€å¸«è«‹ç­é•·æŠŠè€ƒå·___çµ¦åŒå­¸ã€‚" },
        { w: "æ¨¹æ", s: "é ‘çš®çš„å°çŒ´å­åœ¨___ä¸Šç›ªä¾†ç›ªå»ã€‚" },
        { w: "å»£é—Š", s: "ä¸€æœ›ç„¡éš›çš„æµ·æ´‹éå¸¸___ã€‚" },
        { w: "å®¶å‹™", s: "æˆ‘æ˜¯å¥½å¹«æ‰‹ï¼Œç¶“å¸¸å¹«åª½åª½åš___ã€‚" },
        { w: "åˆ°é”", s: "æˆ‘å€‘ä¹˜åçš„é£›æ©Ÿå·²ç¶“å®‰å…¨___é¦™æ¸¯ã€‚" },
        { w: "ç…§é¡§", s: "çˆ¶æ¯è¾›è‹¦åœ°___æˆ‘å€‘æˆé•·ï¼Œæˆ‘å€‘è¦æ„Ÿæ©ã€‚" },
        { w: "å¤±æœ›", s: "é›–ç„¶é€™å ´æ¯”è³½è¼¸äº†ï¼Œä½†å¤§å®¶ä¸è¦æ„Ÿåˆ°___ã€‚" },
        { w: "è«‹æ•™", s: "é‡åˆ°ä¸æ˜ç™½çš„å­—ï¼Œæˆ‘æœƒå‘è€å¸«___ã€‚" },
        { w: "ç…§æ–™", s: "èŠ±åœ’è£çš„èŠ±å‰éœ€è¦ç´°å¿ƒ___æ‰èƒ½é•·å¾—æ¼‚äº®ã€‚" },
        { w: "éº»é›€", s: "çª—å¤–æœ‰å¹¾éš»___åœ¨å±å±å–³å–³åœ°å«ã€‚" },
        { w: "ç¿ ç¶ ", s: "é›¨å¾Œçš„å±±é ­ä¸€ç‰‡___ï¼Œæ™¯è‰²è¿·äººã€‚" },
        { w: "åƒåŠ ", s: "ä»Šå¹´æˆ‘___äº†å­¸æ ¡çš„æ¸¸æ³³æ¯”è³½ã€‚" },
        { w: "ä¸æ…Œä¸å¿™", s: "ä»–___åœ°å¾æ›¸åŒ…æ‹¿å‡ºæ–‡å…·é–‹å§‹å¯«å­—ã€‚" },
        { w: "è¼•æ‰‹è¼•è…³", s: "ç‚ºäº†ä¸åµé†’ç¡è¦ºçš„è²“å’ªï¼Œæˆ‘___åœ°èµ°éã€‚" },
        { w: "æ’²æ’²äº‚è·³", s: "å¿«è¦è¦‹åˆ°å¶åƒäº†ï¼Œæˆ‘çš„å¿ƒç·Šå¼µå¾—___ã€‚" }
    ];

    let score = 0, qIdx = 0, wrongArr = [], curItem = {}, correctChar = "";

    function startGame() {
        if (audioCtx.state === 'suspended') {
            audioCtx.resume();
        }
        document.getElementById('splash-screen').style.display = 'none';
        init();
    }

    function init() {
        if(qIdx >= 20) return end();
        qIdx++;
        document.getElementById("progress").innerText = qIdx;
        curItem = quizData[Math.floor(Math.random()*quizData.length)];
        Math.random() > 0.5 ? setInput() : setSelect();
    }

    function setSelect() {
        document.getElementById("mode-label").innerText = "â­ é¸æ“‡é¡Œ";
        document.getElementById("select-area").style.display = "grid";
        document.getElementById("input-area").style.display = "none";
        document.getElementById("q-box").innerHTML = curItem.s.replace("___", "<span class='blank'>_______</span>");
        let opts = [curItem.w];
        while(opts.length < 4) {
            let r = quizData[Math.floor(Math.random()*quizData.length)].w;
            if(!opts.includes(r)) opts.push(r);
        }
        opts.sort(() => Math.random()-0.5);
        let zone = document.getElementById("select-area");
        zone.innerHTML = "";
        opts.forEach(o => {
            let b = document.createElement("button");
            b.className = "opt-btn";
            b.innerText = o;
            b.onclick = () => o === curItem.w ? showFeedback(true) : showFeedback(false, `ç­”æ¡ˆæ˜¯ã€Œ${curItem.w}ã€`);
            zone.appendChild(b);
        });
    }

    function setInput() {
        document.getElementById("mode-label").innerText = "âœï¸ å¡«å­—é¡Œ";
        document.getElementById("select-area").style.display = "none";
        document.getElementById("input-area").style.display = "block";
        document.getElementById("u-input").value = "";
        document.getElementById("q-box").innerHTML = curItem.s.replace("___", "<span class='blank'>ï¼ˆ ? ï¼‰</span>");
        let arr = curItem.w.split("");
        let idx = Math.floor(Math.random()*arr.length);
        correctChar = arr[idx];
        arr[idx] = "ï¼¿";
        document.getElementById("w-hint").innerText = arr.join("");
    }

    function checkInput() {
        let v = document.getElementById("u-input").value.trim();
        v === correctChar ? showFeedback(true) : showFeedback(false, `æ­£ç¢ºå­—æ˜¯ã€Œ${correctChar}ã€`);
    }

    function showFeedback(win, msg) {
        let layer = document.getElementById("feedback-layer");
        layer.style.display = "flex";
        if(win) {
            score += 10;
            document.getElementById("fb-icon").innerText = "ğŸŒŸ";
            document.getElementById("fb-msg").innerText = "ç­”å°äº†ï¼";
            document.getElementById("fb-msg").style.color = "#51cf66";
            document.getElementById("fb-sub").innerText = "";
            playWinSound();
        } else {
            wrongArr.push(curItem.w);
            document.getElementById("fb-icon").innerText = "ğŸ’¡";
            document.getElementById("fb-msg").innerText = "åŠ æ²¹ï¼å†çœ‹æ¸…æ¥šç­”æ¡ˆ";
            document.getElementById("fb-msg").style.color = "#ff6b6b";
            document.getElementById("fb-sub").innerText = msg;
            playLoseSound();
        }
        document.getElementById("score").innerText = score;
    }

    function closeFeedback() {
        document.getElementById("feedback-layer").style.display = "none";
        init();
    }

    function end() {
        document.getElementById("report-card").style.display = "flex";
        document.getElementById("final-score").innerText = score;
        playFinishSound();
        let box = document.getElementById("wrong-list-box");
        let unique = [...new Set(wrongArr)];
        box.innerHTML = unique.length > 0 ? "<h3>éœ€è¦è¤‡ç¿’ï¼š</h3>" + unique.map(w => `<div>â— ${w}</div>`).join("") : "<h2>æ»¿åˆ†ï¼ğŸ†</h2>";
    }
</script>
</body>
</html>